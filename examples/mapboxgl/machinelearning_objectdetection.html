<!--********************************************************************
* Copyright© 2000 - 2023 SuperMap Software Co.Ltd. All rights reserved.
*********************************************************************-->
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
        <title data-i18n="resources.title_objectdetection"></title>
        <script type="text/javascript" include="bootstrap" src="../js/include-web.js"></script>
        <style>
            body {
                margin: 0;
                padding: 0;
            }

            #map {
                position: absolute;
                top: 0;
                bottom: 0;
                width: 100%;
            }
            .btn {
                position: absolute;
                left: 60px;
                top: 10px;
                text-align: center;
                background: #fff;
                z-index: 1000;
            }
        </style>
    </head>
    <body>
        <input type="button" class="btn btn-default" data-i18n="[value]resources.btn_objectdetection" onclick="addResultLayer()" />
        <div id="map"></div>
        <script
            type="text/javascript"
            exclude="iclient-mapboxgl"
            src="../../dist/mapboxgl/include-mapboxgl.js"
        ></script>
        <script type="text/javascript">
            var host = window.isLocal ? window.server : 'https://iserver.supermap.io';
            var attribution =
                "<a href='https://www.mapbox.com/about/maps/' target='_blank'>© Mapbox </a>" +
                " with <span>© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a> | </span>" +
                " Map Data <span>© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> ";

            var map = new mapboxgl.Map({
                container: 'map',
                style: {
                    version: 8,
                    sources: {
                        'raster-tiles': {
                            attribution: attribution,
                            type: 'raster',
                            tiles: [
                                host + '/iserver/services/map-plane/rest/maps/plane/zxyTileImage.png?z={z}&x={x}&y={y}'
                            ],
                            tileSize: 256
                        }
                    },
                    layers: [
                        {
                            id: 'simple-tiles',
                            type: 'raster',
                            source: 'raster-tiles',
                            minzoom: 0,
                            maxzoom: 22
                        }
                    ]
                },
                center: [-87.89799410302197, 41.97732379151233], // starting position
                zoom: 15.8 // starting zoom
            });
            map.addControl(new mapboxgl.NavigationControl(), 'top-left');
            function addResultLayer() {
                if (map.getLayer('result-layer')) {
                    map.removeLayer('result-layer');
                }
                if (map.getSource('result-layer')) {
                    map.removeSource('result-layer');
                }
                map.addLayer({
                    id: 'result-layer',
                    type: 'raster',
                    source: {
                        attribution: attribution,
                        type: 'raster',
                        tiles: [
                            host +
                                '/iserver/services/map-plane/rest/maps/result_plane/zxyTileImage.png?z={z}&x={x}&y={y}&transparent=true'
                        ],
                        tileSize: 256
                    },
                    minzoom: 0,
                    maxzoom: 22
                });
            }
        </script>
    </body>
</html>
